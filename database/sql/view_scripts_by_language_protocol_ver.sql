-- DROP VIEW public.scripts_by_language_protocol_version;
CREATE OR REPLACE VIEW PUBLIC.SCRIPTS_BY_LANGUAGE_PROTOCOL_VERSION AS
SELECT
  LEDGER_LANGUAGE,
  MAJOR_PROTOCOL_VER,
  COUNT(*) AS NUM_SCRIPTS
FROM
  SERIALISED_SCRIPTS
GROUP BY
  LEDGER_LANGUAGE,
  MAJOR_PROTOCOL_VER
ORDER BY
  (COUNT(*)) DESC;
